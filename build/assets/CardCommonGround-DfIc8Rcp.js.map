{"version":3,"file":"CardCommonGround-DfIc8Rcp.js","sources":["../../src/components/CardCommonGround.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport BaseCard from './BaseCard';\nimport { useSession } from '../context/SessionContext';\nimport contentSearchService from '../services/ContentSearchService';\nimport { Spinner, ErrorState } from './common';\n\ninterface CardCommonGroundProps {\n  onComplete: () => void;\n}\n\nconst CardCommonGround: React.FC<CardCommonGroundProps> = ({ onComplete }) => {\n  const { canvasState, updateCanvasState } = useSession();\n  const [prompts, setPrompts] = useState<string[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [reflection, setReflection] = useState('');\n  const [currentPromptIndex, setCurrentPromptIndex] = useState(0);\n\n  useEffect(() => {\n    const fetchPrompts = async (): Promise<void> => {\n      try {\n        setLoading(true);\n        const fetchedPrompts = await contentSearchService.getMiningPrompts(\n          canvasState.selectedTopic || '', \n          'commonGround'\n        );\n        setPrompts(fetchedPrompts);\n        setLoading(false);\n      } catch (err) {\n        setError(err instanceof Error ? err : new Error('Unknown error'));\n        setLoading(false);\n      }\n    };\n\n    if (canvasState.selectedTopic) {\n      fetchPrompts();\n    }\n  }, [canvasState.selectedTopic]);\n\n  const handleComplete = (): void => {\n    updateCanvasState({\n      miningResults: {\n        ...canvasState.miningResults,\n        commonGround: {\n          reflection,\n          timestamp: new Date().toISOString(),\n        },\n      },\n    });\n    onComplete();\n  };\n\n  if (loading) {\n    return <Spinner message=\"Loading prompts...\" />;\n  }\n\n  if (error) {\n    return <ErrorState title=\"Error loading prompts\" message={error.message} />;\n  }\n\n  const showNextPrompt = (): void => {\n    setCurrentPromptIndex((prevIndex) => (prevIndex + 1) % prompts.length);\n  };\n\n  const showPrevPrompt = (): void => {\n    setCurrentPromptIndex((prevIndex) => (prevIndex - 1 + prompts.length) % prompts.length);\n  };\n\n  return (\n    <BaseCard title=\"Find Common Ground\" onComplete={handleComplete} completionText=\"Continue\">\n      <div style={{ padding: '1rem' }}>\n        <p>{prompts[currentPromptIndex]}</p>\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1rem' }}>\n          <button className=\"btn-secondary\" onClick={showPrevPrompt}>Previous</button>\n          <button className=\"btn-secondary\" onClick={showNextPrompt}>Next</button>\n        </div>\n        <textarea\n          value={reflection}\n          onChange={(e) => setReflection(e.target.value)}\n          placeholder=\"Your reflections...\"\n          style={{ width: '100%', minHeight: '100px', marginTop: '1rem' }}\n        />\n      </div>\n    </BaseCard>\n  );\n};\n\nexport default CardCommonGround;\n"],"names":["CardCommonGround","onComplete","canvasState","updateCanvasState","useSession","prompts","setPrompts","useState","loading","setLoading","error","setError","reflection","setReflection","currentPromptIndex","setCurrentPromptIndex","useEffect","fetchPrompts","fetchedPrompts","contentSearchService","err","handleComplete","jsx","Spinner","ErrorState","showNextPrompt","prevIndex","showPrevPrompt","BaseCard","jsxs","e"],"mappings":"iIAWA,MAAMA,EAAoD,CAAC,CAAE,WAAAC,KAAiB,CAC5E,KAAM,CAAE,YAAAC,EAAa,kBAAAC,CAAA,EAAsBC,EAAA,EACrC,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAmB,CAAA,CAAE,EAC7C,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAuB,IAAI,EAC/C,CAACK,EAAYC,CAAa,EAAIN,EAAAA,SAAS,EAAE,EACzC,CAACO,EAAoBC,CAAqB,EAAIR,EAAAA,SAAS,CAAC,EAE9DS,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAe,SAA2B,CAC9C,GAAI,CACFR,EAAW,EAAI,EACf,MAAMS,EAAiB,MAAMC,EAAqB,iBAChDjB,EAAY,eAAiB,GAC7B,cAAA,EAEFI,EAAWY,CAAc,EACzBT,EAAW,EAAK,CAClB,OAASW,EAAK,CACZT,EAASS,aAAe,MAAQA,EAAM,IAAI,MAAM,eAAe,CAAC,EAChEX,EAAW,EAAK,CAClB,CACF,EAEIP,EAAY,eACde,EAAA,CAEJ,EAAG,CAACf,EAAY,aAAa,CAAC,EAE9B,MAAMmB,EAAiB,IAAY,CACjClB,EAAkB,CAChB,cAAe,CACb,GAAGD,EAAY,cACf,aAAc,CACZ,WAAAU,EACA,UAAW,IAAI,KAAA,EAAO,YAAA,CAAY,CACpC,CACF,CACD,EACDX,EAAA,CACF,EAEA,GAAIO,EACF,OAAOc,EAAAA,IAACC,EAAA,CAAQ,QAAQ,oBAAA,CAAqB,EAG/C,GAAIb,EACF,aAAQc,EAAA,CAAW,MAAM,wBAAwB,QAASd,EAAM,QAAS,EAG3E,MAAMe,EAAiB,IAAY,CACjCV,EAAuBW,IAAeA,EAAY,GAAKrB,EAAQ,MAAM,CACvE,EAEMsB,EAAiB,IAAY,CACjCZ,EAAuBW,IAAeA,EAAY,EAAIrB,EAAQ,QAAUA,EAAQ,MAAM,CACxF,EAEA,OACEiB,EAAAA,IAACM,EAAA,CAAS,MAAM,qBAAqB,WAAYP,EAAgB,eAAe,WAC9E,SAAAQ,EAAAA,KAAC,MAAA,CAAI,MAAO,CAAE,QAAS,QACrB,SAAA,CAAAP,EAAAA,IAAC,IAAA,CAAG,SAAAjB,EAAQS,CAAkB,CAAA,CAAE,EAChCe,EAAAA,KAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,UAAW,MAAA,EACzE,SAAA,CAAAP,MAAC,SAAA,CAAO,UAAU,gBAAgB,QAASK,EAAgB,SAAA,WAAQ,QAClE,SAAA,CAAO,UAAU,gBAAgB,QAASF,EAAgB,SAAA,MAAA,CAAI,CAAA,EACjE,EACAH,EAAAA,IAAC,WAAA,CACC,MAAOV,EACP,SAAWkB,GAAMjB,EAAciB,EAAE,OAAO,KAAK,EAC7C,YAAY,sBACZ,MAAO,CAAE,MAAO,OAAQ,UAAW,QAAS,UAAW,MAAA,CAAO,CAAA,CAChE,CAAA,CACF,CAAA,CACF,CAEJ"}